# CH1 쿠버네티스 빠르게 훑어보기

>> k8s의 핵심 개념인 deployment, pod, service, volume에 대해 알아본다. 앱 구성을 위한 k8s YAML 스크립트로 작성하는 방법과 k8s가 어떻게 컴퓨팅과 네트워크, 스토리지를 추상화하는지 배운다.

## 이해하기
- 앱을 k8s에서 동작하도록 개발하면, 앱은 어디든 배포가 가능하다. 코드 수정 없이 서로 다른 클라우드나 데이터 센터를 오가며 서비스 이전이 가능하다.
- 하지만, 복잡하다. 간단한 애플리케이션이라도 여러 개의 컴포넌트로 구성되며, 여러 라인의 스크립트로 작성해야 한다.
  - 인프라 수준의 로드밸런싱, 네트워크, 스토리지와 컴퓨팅 등을 애플리케이션 설정 영역으로 가져왔다.

## 1.1 쿠버네티스 이해하기
- 쿠버네티스는 컨테이너를 실행하는 플랫폼이다.
- 컨테이너화된 어플리케이션의 시작, 롤링 업데이트, 서비스 수준 유지, 수요에 따른 스케일링, 보안 접근 등 다양한 기능을 제공한다.
- 핵심 개념 2가지
  - 어플리케이션 정의에 사용되는 API
  - 어플리케이션이 실제로 동작하는 클러스터
    - 클러스터란 도커 같은 컨테이너 런타임이 동작하는 여러 대의 서버가 모여 쿠버네티스 같은 하나의 논리적 단위를 구성한 것을 의미.
- 쿠버네티스는 컨테이너 오케스트레이션 도구
  - 클러스터는 여러 개의 서버 노드로 구성된 하나의 논리적 단위
    - 노드 중 일부는 쿠버네티스 API를 실행 / 나머지 노드는 컨테이너 속에서 동작하는 어플리케이션을 실행
    - 각 노드에서는 컨테이너 런타임이 실행되고, 여러 가지 컨테이너 런타임을 지원
- 클러스터 관리자는 노드라고 하는 각각의 서버를 관리한다.
  - 노드 추가, 노드 제외, 노드 롤링 업데이트 등
- 쿠버네티스 클러스터의 목적
  - 어플리케이션을 실행하는 것
  - YAML 파일에 어플리케이션을 기술 -> 이 파일을 쿠버네티스 API에 제공 -> 쿠버네티스가 파일에 기술된 어플리케이션 구성을 이해 -> 클러스터 현재 상태와 비교
  - 구성에 따라 어플리케이션을 실행 및 관리해주고, 이상이 있다면 재시작한다.
  - 컨테이너 뿐만 아니라, 분산 DB를 통해 구성 정보나 비밀값도 저장이 가능하다.
- => 모든 어플리케이션을 모두 똑같은 방식으로 기술하고 배포하고 관리할 수 있다는 것.

### 개념
1. 어플리케이션 매니페스트
   - 어플리케이션을 기술한 YAML 파일
   - 파일 내용이 어플리케이션을 구성하는 모든 컴포넌트의 목록이다.
2. 리소스
- ![Image](https://github.com/user-attachments/assets/f627cfcc-67e1-4858-b04a-55fe3c6adc2d)


## 컨테이너
- 쿠버네티스를 이루는 기본 오브젝트는 파드 -> 파드는 컨테이너로 구성 -> 컨테이너를 만들고 관리하는 도구는 대표적으로 도커
- 여러 어플리케이션이 이미 도커 이미지로 배포되고 있어 도커를 몰라도 쿠버네티스 환경을 사용할 수는 있지만, 쿠버네티스를 이루는 기술 자체는 컨테이너를 벗어날 수 없다.

### 파드, 컨테이너, 도커, 쿠버네티스의 관계
- 쿠버네티스 클러스터 -> 워커 노드와 마스터 노드 -> 워커 노드 하위 여러 개의 파드들 -> 파드는 1개 이상의 컨테이너로 구성
- 파드는 쿠버네티스로부터 IP를 받아 컨테이너가 외부와 통신할 수 있는 경로를 제공
- 컨테이너들이 정상적으로 작동하는지 확인하고 네트워크나 저장 공간을 서로 공유하게 함

#### 컨테이너
- 이 구조를 이루는 가장 기본인 컨테이너는 하나의 운영 체제 안에서 커널을 공유하며 **개별적인 실행 환경**을 제공하는 격리된 공간
- CPU, 네트워크, 메모리와 같은 시스템 자원을 독자적으로 사용하도록 할당된 환경을 말함

#### 도커
- 컨테이너 관리 도구로, 컨테이너 관리 기능 외에도 컨테이너를 실행하는 데 필요한 이미지를 만들거나 공유하는 등의 기능을 제공
- 사용자가 명령어를 입력하는 명령어 도구 CLI와 명령을 받아들이는 도커 데몬으로 구성되어 있음


## 환경 구성
- 도커 데스크톱을 이용 시 로ㄹ 컴퓨터에서 간단하게 쿠네티스를 실행할 수 있다.
- 도커, 쿠버네티스, 명령행 도구까지 한번에 설치할 수 있는 패키지다.
- 쿠버네티스 자체의 구성 요소는 리눅스 컨테이너 형태로 실행된다.

### kubectl
- 쿠버네티스는 kubectl이라는 명령행 도구로 사용할 수 있다.
- kubectl은 쿠버네티스 클러스터에 접속한 후 쿠버네티스 API를 이용하여 클러스터를 관리한다.